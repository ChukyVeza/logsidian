<!-- âœ… SCRIPT MEJORADO - ESTRUCTURA ANIDADA CORRECTA -->
    <script>
    // ðŸš¨ CONVERSIÃ“N MEJORADA CON ANIDACIÃ“N INTELIGENTE ðŸš¨
    function convertAllCheckboxes() {
      console.log('ðŸ”„ Buscando checkboxes para convertir...');
      
      const allElements = document.querySelectorAll('*');
      let convertedCount = 0;
      
      allElements.forEach(element => {
        if (element.tagName !== 'INPUT' && (element.innerHTML.includes('[ ]') || element.innerHTML.includes('[x]'))) {
          
          if (element.innerHTML.includes('[ ]')) {
            element.innerHTML = element.innerHTML.replace(/\[ \]/g, '<input type="checkbox" class="custom-checkbox-js">');
            convertedCount++;
          }
          
          if (element.innerHTML.includes('[x]')) {
            element.innerHTML = element.innerHTML.replace(/\[x\]/g, '<input type="checkbox" class="custom-checkbox-js" checked>');
            convertedCount++;
          }
        }
      });
      
      console.log(`âœ… Convertidos ${convertedCount} checkboxes`);
    }

    // ðŸš¨ CONVERSIÃ“N DE PÃRRAFOS A ESTRUCTURA DE LISTAS ANIDADAS ðŸš¨
    function convertParagraphsToNestedLists() {
      console.log('ðŸ”„ Convirtiendo pÃ¡rrafos a estructura anidada...');
      
      const paragraphs = document.querySelectorAll('p');
      let convertedCount = 0;
      
      paragraphs.forEach(paragraph => {
        const content = paragraph.innerHTML;
        
        if ((content.includes('- [ ]') || content.includes('- [x]')) && content.includes('<br>')) {
          const lines = content.split('<br>');
          const listStack = [];
          let rootList = null;
          let currentList = null;
          let lastIndentLevel = 0;
          
          lines.forEach((line, index) => {
            if (line.trim()) {
              // Calcular nivel de indentaciÃ³n
              const indentSpaces = (line.match(/^(\s*)/) || [''])[0].length;
              const indentLevel = Math.floor(indentSpaces / 2);
              
              // Crear elemento de lista
              const listItem = document.createElement('li');
              listItem.className = 'converted-task-item';
              
              // Procesar contenido de la lÃ­nea
              let cleanLine = line.trim();
              cleanLine = cleanLine.replace(/\[ \]/g, '<input type="checkbox" class="custom-checkbox-js">');
              cleanLine = cleanLine.replace(/\[x\]/g, '<input type="checkbox" class="custom-checkbox-js" checked>');
              cleanLine = cleanLine.replace(/^-\s+/, '');
              
              listItem.innerHTML = cleanLine;
              
              // Manejar cambios de nivel
              if (indentLevel > lastIndentLevel) {
                // Crear nueva lista anidada
                const nestedList = document.createElement('ul');
                nestedList.className = 'converted-task-list';
                
                if (currentList && currentList.lastElementChild) {
                  currentList.lastElementChild.appendChild(nestedList);
                  listStack.push(currentList);
                  currentList = nestedList;
                }
              } else if (indentLevel < lastIndentLevel) {
                // Regresar niveles
                const levelsToPop = lastIndentLevel - indentLevel;
                for (let i = 0; i < levelsToPop && listStack.length > 0; i++) {
                  currentList = listStack.pop();
                }
              }
              
              // Inicializar lista raÃ­z si es necesario
              if (!rootList) {
                rootList = document.createElement('ul');
                rootList.className = 'converted-task-list';
                currentList = rootList;
              }
              
              // Agregar item a la lista actual
              if (currentList) {
                currentList.appendChild(listItem);
              }
              
              lastIndentLevel = indentLevel;
            }
          });
          
          // Reemplazar pÃ¡rrafo con la estructura creada
          if (rootList) {
            const container = document.createElement('div');
            container.className = 'nested-list-container';
            container.appendChild(rootList);
            paragraph.parentNode.replaceChild(container, paragraph);
            convertedCount++;
          }
        }
      });
      
      console.log(`âœ… Convertidos ${convertedCount} pÃ¡rrafos a listas anidadas`);
    }

    // ðŸš¨ CONVERSIÃ“N DE ESTRUCTURA PLANA EXISTENTE ðŸš¨
    function convertFlatListsToNested() {
      console.log('ðŸ”„ Mejorando listas planas existentes...');
      
      // Buscar pÃ¡rrafos que contengan mÃºltiples items de lista
      const paragraphs = document.querySelectorAll('p');
      paragraphs.forEach(paragraph => {
        const htmlContent = paragraph.innerHTML;
        
        if ((htmlContent.includes('- [ ]') || htmlContent.includes('- [x]')) && 
            htmlContent.split('<br>').length > 1) {
          
          const lines = htmlContent.split('<br>');
          const list = document.createElement('ul');
          list.className = 'converted-task-list';
          
          lines.forEach(line => {
            if (line.trim()) {
              const listItem = document.createElement('li');
              listItem.className = 'converted-task-item';
              
              let processedLine = line.trim();
              processedLine = processedLine.replace(/\[ \]/g, '<input type="checkbox" class="custom-checkbox-js">');
              processedLine = processedLine.replace(/\[x\]/g, '<input type="checkbox" class="custom-checkbox-js" checked>');
              processedLine = processedLine.replace(/^-\s+/, '');
              
              listItem.innerHTML = processedLine;
              list.appendChild(listItem);
            }
          });
          
          paragraph.parentNode.replaceChild(list, paragraph);
        }
      });
    }

    // ðŸš¨ MEJORA DE ESTRUCTURAS EXISTENTES ðŸš¨
    function enhanceExistingStructures() {
      console.log('ðŸ”„ Mejorando estructuras existentes...');
      
      // Aplicar clases a listas existentes
      const existingLists = document.querySelectorAll('ul, ol');
      existingLists.forEach(list => {
        if (!list.classList.contains('converted-task-list')) {
          list.classList.add('converted-task-list');
        }
        
        // Aplicar clases a items existentes
        const listItems = list.querySelectorAll('li');
        listItems.forEach(item => {
          if (!item.classList.contains('converted-task-item')) {
            item.classList.add('converted-task-item');
          }
        });
      });
    }

    // ðŸš¨ FUNCIÃ“N PRINCIPAL MEJORADA ðŸš¨
    function convertAllElements() {
      console.log('=== INICIANDO CONVERSIÃ“N COMPLETA ===');
      convertFlatListsToNested();
      convertParagraphsToNestedLists();
      convertAllCheckboxes();
      enhanceExistingStructures();
      console.log('=== CONVERSIÃ“N COMPLETADA ===');
    }

    // ðŸš¨ INICIALIZACIÃ“N ROBUSTA ðŸš¨
    function initializeConversion() {
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', convertAllElements);
      } else {
        convertAllElements();
      }
      
      // MÃºltiples intentos para contenido dinÃ¡mico
      const delays = [50, 100, 300, 500, 1000, 2000];
      delays.forEach(delay => {
        setTimeout(convertAllElements, delay);
      });
    }

    // ðŸš¨ OBSERVADOR DE CAMBIOS EN EL DOM ðŸš¨
    function setupMutationObserver() {
      const observer = new MutationObserver(function(mutations) {
        let shouldConvert = false;
        
        mutations.forEach(mutation => {
          if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
            shouldConvert = true;
          } else if (mutation.type === 'characterData') {
            shouldConvert = true;
          }
        });
        
        if (shouldConvert) {
          setTimeout(convertAllElements, 100);
        }
      });
      
      observer.observe(document.body, {
        childList: true,
        subtree: true,
        characterData: true
      });
    }

    // ðŸš¨ EJECUCIÃ“N PRINCIPAL ðŸš¨
    initializeConversion();
    setupMutationObserver();

    // Exportar funciones para debugging
    window.convertAllElements = convertAllElements;
    console.log('âœ… Script de conversiÃ³n cargado correctamente');
    </script>